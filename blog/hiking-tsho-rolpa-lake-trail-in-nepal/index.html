<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Fixing my broken Docker Immich+Traefik setup Â· Subodh Dahal</title><script src="https://app.rybbit.io/api/script.js" async defer data-site-id="dbed437cc8b1"></script><style>li[data-v-c09aafd1]{display:inline-block}a[data-v-c09aafd1]{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}</style><style>pre code .line{display:block}</style><link rel="stylesheet" href="/_nuxt/entry.DwsUc0ZZ.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/hiking-tsho-rolpa-lake-trail-in-nepal/_payload.json?3b85eb27-f9e1-4157-a9db-acb8c4a26f62"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B5AoXER0.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BkscSFI7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DZ4-qATz.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUzNxGF_.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BDTqAl9o.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bd1FLTUK.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHeHs0jt.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/D29hftCV.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/4VqJC41G.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BEf8em8Z.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DgmvpGFs.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BO3p1XjF.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CxWcpviW.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CjWeLsj8.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/JUWA7N0D.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/3b85eb27-f9e1-4157-a9db-acb8c4a26f62.json"><meta property="og:image" content="https://subodhdahal.com/__og-image__/static/blog/hiking-tsho-rolpa-lake-trail-in-nepal/og.png"><meta property="og:image:type" content="image/png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://subodhdahal.com/__og-image__/static/blog/hiking-tsho-rolpa-lake-trail-in-nepal/og.png"><meta name="twitter:image:src" content="https://subodhdahal.com/__og-image__/static/blog/hiking-tsho-rolpa-lake-trail-in-nepal/og.png"><meta property="og:image:width" content="1200"><meta name="twitter:image:width" content="1200"><meta property="og:image:height" content="600"><meta name="twitter:image:height" content="600"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/rss+xml" title="Subodh Dahal (RSS)" href="/rss.xml"><link rel="alternate" type="application/atom+xml" title="Subodh Dahal (Atom)" href="/atom.xml"><link rel="canonical" href="https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal"><meta name="description" content="Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I'd misconfigured my Docker networking with Traefik. Here's how I figured it out and what I changed."><meta property="og:title" content="Fixing my broken Docker Immich+Traefik setup"><meta property="og:description" content="Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I'd misconfigured my Docker networking with Traefik. Here's how I figured it out and what I changed."><meta property="og:url" content="https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal"><meta property="og:type" content="article"><meta name="twitter:title" content="Fixing my broken Docker Immich+Traefik setup"><meta name="twitter:description" content="Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I'd misconfigured my Docker networking with Traefik. Here's how I figured it out and what I changed."><meta property="article:published_time" content="2025-10-31T00:00:00.000Z"><meta property="article:modified_time" content="2025-10-31T00:00:00.000Z"><meta property="article:tag" content="homelab"><meta property="article:tag" content="networking"><script type="module" src="/_nuxt/B5AoXER0.js" crossorigin></script><meta property="og:site_name" content="Subodh Dahal"><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div><div class="dark:text-gray-50"><div class="shadow-sm border-b border-gray-200 dark:border-gray-700"><header class="md:container flex justify-between mx-auto px-5 py-4"><div class="mb-4"><a href="/" class=""><svg viewbox="0 0 21.349 12.467" xmlns="http://www.w3.org/2000/svg" class="logo dark:fill-gray-50 dark:stroke-gray-50 fill-gray-700 stroke-gray-700 h-12 w-12 transition-transform hover:scale-105"><g transform="translate(-13.999 -74.065)"><path d="m18.285 76.065c-1.2594 0-2.286 1.0372-2.286 2.2966 0 1.27 1.0266 2.2966 2.286 2.2966h3.8841c0.86783 0 1.5769 0.70908 1.5769 1.5875 0 0.86783-0.70908 1.5769-1.5769 1.5769h-6.1701v0.70908h6.1701c1.2594 0 2.2966-1.0266 2.2966-2.286 0-1.27-1.0372-2.2966-2.2966-2.2966h-3.8841c-0.86783 0-1.5769-0.70908-1.5769-1.5875 0-0.86783 0.70908-1.5769 1.5769-1.5769h7.1253v-0.71967z" stroke-width=".52917" style="white-space:pre;"></path><path d="m30.172 76.065h-4.2333v0.71967h4.2333c1.9368 0 3.5137 1.5769 3.5137 3.5137 0 1.9473-1.5769 3.5242-3.5137 3.5242h-3.5242v-3.8735h-0.70908v4.5826h4.2333c2.3283 0 4.2333-1.8944 4.2333-4.2333 0-2.3283-1.905-4.2333-4.2333-4.2333z" stroke-width=".52917" style="white-space:pre;"></path></g></svg></a></div><div class="md:hidden"><button class="flex items-center p-3 border-2 rounded-md dark:text-gray-50 dark:border-gray-600 text-gray-800 border-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Mobile Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v15z"></path></svg></button></div><ul class="hidden text-lg mt-1 flex flex-col md:flex-row list-none md:block md:flex items-center gap-6"><li><a href="/blog" class="hover:text-blue-500 relative pb-1 font-medium transition-all hover:after:absolute hover:after:bottom-0 hover:after:left-0 hover:after:w-full hover:after:h-0.5 hover:after:bg-blue-500"> Blog </a></li><li><a href="/library" class="hover:text-blue-500 relative pb-1 font-medium transition-all hover:after:absolute hover:after:bottom-0 hover:after:left-0 hover:after:w-full hover:after:h-0.5 hover:after:bg-blue-500"> Library </a></li><li><a href="/#about" class="hover:text-blue-500 font-medium transition-colors"> About </a></li><li><button aria-label="system" type="button" class="block mt-1" title="Switch to dark mode"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 lg:h-5 lg:w-5 fill-gray-700" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></li></ul><div class="hidden navbar-menu relative z-50"><div class="navbar-backdrop fixed inset-0 bg-gray-800 dark:bg-gray-600 opacity-25"></div><nav class="fixed top-0 left-0 bottom-0 flex flex-col w-5/6 max-w-sm py-6 px-6 bg-gray-100 dark:bg-gray-800 overflow-y-auto transform transition-transform duration-300 ease-in-out"><div class="flex items-center mb-8"><a href="/" class="mr-auto"><svg viewbox="0 0 21.349 12.467" xmlns="http://www.w3.org/2000/svg" class="logo dark:fill-gray-50 dark:stroke-gray-50 fill-gray-700 stroke-gray-700 h-15 w-15"><g transform="translate(-13.999 -74.065)"><path d="m18.285 76.065c-1.2594 0-2.286 1.0372-2.286 2.2966 0 1.27 1.0266 2.2966 2.286 2.2966h3.8841c0.86783 0 1.5769 0.70908 1.5769 1.5875 0 0.86783-0.70908 1.5769-1.5769 1.5769h-6.1701v0.70908h6.1701c1.2594 0 2.2966-1.0266 2.2966-2.286 0-1.27-1.0372-2.2966-2.2966-2.2966h-3.8841c-0.86783 0-1.5769-0.70908-1.5769-1.5875 0-0.86783 0.70908-1.5769 1.5769-1.5769h7.1253v-0.71967z" stroke-width=".52917" style="white-space:pre;"></path><path d="m30.172 76.065h-4.2333v0.71967h4.2333c1.9368 0 3.5137 1.5769 3.5137 3.5137 0 1.9473-1.5769 3.5242-3.5137 3.5242h-3.5242v-3.8735h-0.70908v4.5826h4.2333c2.3283 0 4.2333-1.8944 4.2333-4.2333 0-2.3283-1.905-4.2333-4.2333-4.2333z" stroke-width=".52917" style="white-space:pre;"></path></g></svg></a><button class="navbar-close p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"><svg class="h-6 w-6 text-gray-400 cursor-pointer hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> Ã <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div><ul><li class="mb-5"><a href="/blog" class="hover:text-blue-500 relative pb-1 inline-block text-lg font-medium transition-all"> Blog </a></li><li class="mb-5"><a href="/library" class="hover:text-blue-500 relative pb-1 inline-block text-lg font-medium transition-all"> Library </a></li><li class="mb-5"><a href="/#about" class="hover:text-blue-500 text-lg font-medium transition-colors"> About </a></li><li><button aria-label="system" type="button" class="block mt-1" title="Switch to dark mode"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 lg:h-5 lg:w-5 fill-gray-700" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg></button></li></ul></div><div class="mt-auto"><div class="pt-6"><div class="self-center no-prose fill-gray-700 flex flex-wrap justify-center" data-v-c09aafd1><li data-v-c09aafd1><a href="https://www.linkedin.com/in/subodhdahal" title="LinkedIn" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li data-v-c09aafd1><a href="https://www.xing.com/profile/Subodh_Dahal" title="Xing" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M162.7 210c-1.8 3.3-25.2 44.4-70.1 123.5-4.9 8.3-10.8 12.5-17.7 12.5H9.8c-7.7 0-12.1-7.5-8.5-14.4l69-121.3c.2 0 .2-.1 0-.3l-43.9-75.6c-4.3-7.8.3-14.1 8.5-14.1H100c7.3 0 13.3 4.1 18 12.2l44.7 77.5zM382.6 46.1l-144 253v.3L330.2 466c3.9 7.1.2 14.1-8.5 14.1h-65.2c-7.6 0-13.6-4-18-12.2l-92.4-168.5c3.3-5.8 51.5-90.8 144.8-255.2 4.6-8.1 10.4-12.2 17.5-12.2h65.7c8 0 12.3 6.7 8.5 14.1z"></path></svg></a></li><li data-v-c09aafd1><a href="https://github.com/SubodhDahal" title="GitHub" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li data-v-c09aafd1><a href="https://stackoverflow.com/users/1083422/sub0dh" title="Stackoverflow" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg></a></li><li data-v-c09aafd1><a href="https://instagram.com/wanderluster_subodh" title="Instagram" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a></li><li data-v-c09aafd1><a href="/rss.xml" title="RSS Feed" rel="alternate" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M4 11.2c5.7 0 10.2 4.5 10.2 10.2H18c0-7.7-6.3-14-14-14v3.8zm0 5.7c2.5 0 4.5 2 4.5 4.5H12c0-4.4-3.6-8-8-8v3.5zm2.4 4.6c0 1.3-1.1 2.4-2.4 2.4S1.6 22.8 1.6 21.5s1.1-2.4 2.4-2.4 2.4 1.1 2.4 2.4z"></path></svg></a></li></div></div></div></nav></div></header></div></div><div class="nuxt-content bg-white dark:bg-secondary-900" data-v-ba4e472e><nav aria-label="Breadcrumb" class="container py-4" data-v-ba4e472e><ol class="flex space-x-2 text-sm text-secondary-500 dark:text-secondary-400" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/" class="hover:text-primary-600" itemprop="item"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"></li><li class="text-secondary-300">/</li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/blog" class="hover:text-primary-600" itemprop="item"><span itemprop="name">Blog</span></a><meta itemprop="position" content="2"></li><!--[--><li class="text-secondary-300">/</li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem" class="truncate"><span itemprop="name">Fixing my broken Docker Immich+Traefik setup</span><meta itemprop="position" content="3"></li><!--]--></ol></nav><div class="cover container py-2" data-v-ba4e472e><div class="md:flex items-center gap-12" data-v-ba4e472e><div class="flex-1" data-v-ba4e472e><h1 class="font-serif text-4xl md:text-5xl font-bold mb-4 text-secondary-900 dark:text-white" data-v-ba4e472e>Fixing my broken Docker Immich+Traefik setup</h1><p class="text-lg md:text-xl mb-4 text-secondary-600 dark:text-secondary-300" data-v-ba4e472e>Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I&#39;d misconfigured my Docker networking with Traefik. Here&#39;s how I figured it out and what I changed.</p><div class="tags my-6" data-v-ba4e472e><!--[--><span class="inline-block text-slate-600 text-xs bg-slate-100 px-2 py-0.5 rounded mr-3">HOMELAB</span><span class="inline-block text-slate-600 text-xs bg-slate-100 px-2 py-0.5 rounded mr-3">NETWORKING</span><!--]--></div><div class="text-secondary-500 dark:text-secondary-400 text-sm" data-v-ba4e472e> Posted on October 31, 2025</div></div><div class="flex-1 mt-8 md:mt-0" data-v-ba4e472e><img data-nuxt-img srcset="/_ipx/f_webp&amp;s_800x400/images/broken-docker-network.png 1x, /_ipx/f_webp&amp;s_800x400/images/broken-docker-network.png 2x" onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="Depiction of broken docker networking" class="rounded-lg shadow-lg w-full object-cover max-h-[500px]" loading="lazy" src="/_ipx/f_webp&amp;s_800x400/images/broken-docker-network.png" data-v-ba4e472e></div></div></div><div class="container" data-v-ba4e472e><article class="max-w-3xl mx-auto" data-v-ba4e472e><div class="blog-page pb-5" data-v-ba4e472e><p><!--[-->I have been using <a href="https://github.com/immich-app/immich" rel="nofollow"><!--[-->Immich<!--]--></a> for over a year in my homelab. Immich is a photo and video management platform similar to Google Photos or iCloud Photos, but it is self-hosted. This means I own and control all data. It is open-source, runs on my own infrastructure, no subscriptions, and no company uses my family photos to train models.<!--]--></p><p><!--[-->Until recently, Immich was in beta. Things break in beta. That&#39;s kind of the point. I had this problem where new pictures and videos added to my external library weren&#39;t being indexed, and metadata wasn&#39;t extracted for many of these assets. I chalked it up to active development and moved on.<!--]--></p><p><!--[-->Immich hit stable version recently. Kudos to the team and the contributors for making it happen and giving us a great alternative to proprietary platforms.<!--]--></p><p><!--[-->After learning about the stable release, I pulled the latest version hoping that the issues I was facing would be fixed. Unfortunately, my photos and videos still weren&#39;t being indexed after a certain point and none of the jobs seem to work. I looked for pending issues but found none that match my problem. Then it occurred to me that maybe the issue wasn&#39;t in Immich itself. Maybe it was my setup.<!--]--></p><h2 id="the-setup"><a href="#the-setup"><!--[-->The Setup<!--]--></a></h2><p><!--[-->I&#39;m running Immich and all related services on my homelab on an Ubuntu VM using Docker Compose, mostly following the <a href="https://docs.immich.app/install/docker-compose" rel="nofollow"><!--[-->official documentation<!--]--></a>.<!--]--></p><p><!--[-->At some point in the past, I had introduced <a href="https://doc.traefik.io/traefik/" rel="nofollow"><!--[-->Traefik<!--]--></a> as a reverse proxy for Immich, following the <a href="https://www.youtube.com/watch?v=CmUzMi5QLzI" rel="nofollow"><!--[-->tutorial from Jim&#39;s Garage<!--]--></a>. Traefik gives me domain-based access to services instead of me having to remember the IP address and port number for them. The services are still accessible only on my home network, but I can reach them using an easy-to-remember address like <code><!--[-->https://photos.home.mydomain.com<!--]--></code><!--]--></p><p><!--[-->All I had to do was add a proxy network to the services and some Traefik labels to specify the domain. A quick check had shown that I could access my previous photos and videos correctly, so I assumed everything was working.<!--]--></p><p><!--[-->But it turns out not everything was.<!--]--></p><h2 id="the-issue"><a href="#the-issue"><!--[-->The Issue<!--]--></a></h2><p><!--[-->I had connected every service to the same proxy network. One network, everything talks to everything. What could go wrong, right?<!--]--></p><p><!--[-->Immich could connect to Postgres just fine and retrieve data about previously indexed photos and videos. Redis, though, wasn&#39;t receiving any jobs which caused the asynchrounous background tasks like scanning libraries to not be initiated at all.<!--]--></p><p><!--[-->To try to isolate the networking issue, I commented out the proxy network usage for all services and accessed immich using <code><!--[-->&lt;server ip&gt;:&lt;immich-server port&gt;<!--]--></code>. Running the job for rescanning external libraries worked as intended and I could see the new media in my Immich timeline.<!--]--></p><p><!--[-->I still am not 100% sure of the reason but I suspect it to be a timing issue. The external proxy network&#39;s DNS wasn&#39;t ready when Immich started up. Some connections succeeded by luck or retry logic. Others failed and never recovered. Redis happened to be one that failed.<!--]--></p><h2 id="the-fix"><a href="#the-fix"><!--[-->The Fix<!--]--></a></h2><p><!--[-->I split the setup into two networks:<!--]--></p><ol><!--[--><li><!--[--><strong><!--[-->Internal network<!--]--></strong>: Database, Redis, Immich machine learning engine, and Immich all communicate here<!--]--></li><li><!--[--><strong><!--[-->Proxy network<!--]--></strong>: Only Immich server connects here so Traefik can route to it<!--]--></li><!--]--></ol><p><!--[-->Here&#39;s a simplified version of my new <code><!--[-->docker-compose.yml<!--]--></code> file:<!--]--></p><pre class="language-text"><!--[--><code>services:
    immich-server:
        image: immich:latest
        networks:
        - internal # Talk to database, Redis, etc.
        - proxy    # Accessible via Traefik
        labels:
        - &quot;traefik.enable=true&quot;
        - &quot;traefik.docker.network=proxy&quot;
        - &quot;traefik.http.routers.immich.rule=Host(`photos.home.mydomain.com`)&quot;
        - &quot;traefik.http.services.immich.loadbalancer.server.port=3001&quot;

    immich-machine-learning:
        networks:
        - internal

    database:
        networks:
        - internal

    redis:
        networks:
        - internal

    networks:
        internal:
        driver: bridge
        proxy:
        external: true
</code><!--]--></pre><p><!--[-->The <code><!--[-->traefik.docker.network=proxy<!--]--></code> label tells Traefik which network to actually use for routing.<!--]--></p><h2 id="how-it-works"><a href="#how-it-works"><!--[-->How It Works<!--]--></a></h2><p><!--[-->The internal network is created fresh, so DNS setup is guaranteed to work. When Immich needs to send jobs to Redis or read from Postgres, the names resolve consistently and quickly. External traffic from Traefik arrives on the proxy network instead. Both networks point to the same containers but through different paths, so the timing issues disappear.<!--]--></p><p><!--[-->Now the indexing of photos and all the other jobs, e.g.. extracting metadata, creating thumbnails work as intended.<!--]--></p></div><div class="flex flex-col sm:flex-row gap-4 justify-between p-4 sm:p-6 my-8 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-800/50" data-v-ba4e472e><!----><div class="next flex-1"><a href="/blog/fixing-docker-immich-traefik-setup" class="group block"><div class="text-sm text-slate-500 dark:text-slate-400 mb-1 text-left sm:text-right">Next Article</div><div class="flex items-center justify-start sm:justify-end text-slate-700 dark:text-slate-300 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"><span class="line-clamp-2 text-left sm:text-right">Fixing my broken Docker Immich+Traefik setup</span><span class="flex-shrink-0 ml-2">â</span></div></a></div></div></article></div></div><footer class="py-5 flex justify-center items-center text-center bg-gray-100 dark:bg-gray-600"><div class="self-center no-prose fill-gray-700 flex flex-wrap justify-center" data-v-c09aafd1><li data-v-c09aafd1><a href="https://www.linkedin.com/in/subodhdahal" title="LinkedIn" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></li><li data-v-c09aafd1><a href="https://www.xing.com/profile/Subodh_Dahal" title="Xing" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M162.7 210c-1.8 3.3-25.2 44.4-70.1 123.5-4.9 8.3-10.8 12.5-17.7 12.5H9.8c-7.7 0-12.1-7.5-8.5-14.4l69-121.3c.2 0 .2-.1 0-.3l-43.9-75.6c-4.3-7.8.3-14.1 8.5-14.1H100c7.3 0 13.3 4.1 18 12.2l44.7 77.5zM382.6 46.1l-144 253v.3L330.2 466c3.9 7.1.2 14.1-8.5 14.1h-65.2c-7.6 0-13.6-4-18-12.2l-92.4-168.5c3.3-5.8 51.5-90.8 144.8-255.2 4.6-8.1 10.4-12.2 17.5-12.2h65.7c8 0 12.3 6.7 8.5 14.1z"></path></svg></a></li><li data-v-c09aafd1><a href="https://github.com/SubodhDahal" title="GitHub" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li data-v-c09aafd1><a href="https://stackoverflow.com/users/1083422/sub0dh" title="Stackoverflow" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg></a></li><li data-v-c09aafd1><a href="https://instagram.com/wanderluster_subodh" title="Instagram" target="_blank" rel="me noopener noreferrer" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a></li><li data-v-c09aafd1><a href="/rss.xml" title="RSS Feed" rel="alternate" data-v-c09aafd1><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="h-8 w-8 mr-2 text-gray-700" data-v-c09aafd1><path d="M4 11.2c5.7 0 10.2 4.5 10.2 10.2H18c0-7.7-6.3-14-14-14v3.8zm0 5.7c2.5 0 4.5 2 4.5 4.5H12c0-4.4-3.6-8-8-8v3.5zm2.4 4.6c0 1.3-1.1 2.4-2.4 2.4S1.6 22.8 1.6 21.5s1.1-2.4 2.4-2.4 2.4 1.1 2.4 2.4z"></path></svg></a></li></div></footer></div></div><div id="teleports"></div><script type="application/ld+json" data-nuxt-schema-org="true" data-hid="schema-org-graph">{"@context":"https://schema.org","@graph":[{"@id":"https://subodhdahal.com/#website","@type":"WebSite","description":"Personal website and blog of Subodh Dahal","inLanguage":"en","name":"Subodh Dahal","url":"https://subodhdahal.com/"},{"@id":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal#webpage","@type":"WebPage","dateModified":"2025-10-31T00:00:00.000Z","datePublished":"2025-10-31T00:00:00.000Z","description":"Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I'd misconfigured my Docker networking with Traefik. Here's how I figured it out and what I changed.","name":"Fixing my broken Docker Immich+Traefik setup","url":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal","isPartOf":{"@id":"https://subodhdahal.com/#website"},"potentialAction":[{"@type":"ReadAction","target":["https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal"]}]},{"@id":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal#/schema//1b5de0a","person":{"name":"Subodh Dahal","url":"https://subodhdahal.com","image":"/images/me.jpg","jobTitle":"Software Engineer","sameAs":["https://github.com/subodhdahal","https://linkedin.com/in/subodhdahal"]},"website":{"name":"Subodh Dahal","url":"https://subodhdahal.com","description":"Subodh Dahal -  Software Engineer, Automation Enthusiast, Hobbyist Photographer & Avid Ponderer","image":"https://subodhdahal.com/twitter-card.png"}},{"@id":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal#article","@type":"Article","dateModified":"2025-10-31T00:00:00.000Z","datePublished":"2025-10-31T00:00:00.000Z","description":"Photo indexing and other jobs failed in my Immich+Traefik setup. Turns out I'd misconfigured my Docker networking with Traefik. Here's how I figured it out and what I changed.","headline":"Fixing my broken Docker Immich+Traefik setup","inLanguage":"en","thumbnailUrl":"https://subodhdahal.com/images/broken-docker-network.png","articleSection":["homelab","networking"],"author":{"@id":"https://subodhdahal.com/#/schema/person/3eb701a"},"image":{"@id":"https://subodhdahal.com/#/schema/image/234869f"},"isPartOf":{"@id":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal#webpage"},"mainEntityOfPage":{"@id":"https://subodhdahal.com/blog/hiking-tsho-rolpa-lake-trail-in-nepal#webpage"}},{"@id":"https://subodhdahal.com/#/schema/person/3eb701a","@type":"Person","name":"Subodh Dahal","url":"https://subodhdahal.com"},{"@id":"https://subodhdahal.com/#/schema/image/234869f","@type":"ImageObject","contentUrl":"https://subodhdahal.com/images/broken-docker-network.png","inLanguage":"en","url":"https://subodhdahal.com/images/broken-docker-network.png"}]}</script><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/blog/hiking-tsho-rolpa-lake-trail-in-nepal/_payload.json?3b85eb27-f9e1-4157-a9db-acb8c4a26f62">[{"state":1,"once":17,"_errors":18,"serverRendered":5,"path":20,"prerenderedAt":21},["Reactive",2],{"$scolor-mode":3,"$snuxt-seo-utils:routeRules":7,"$ssite-config":8},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{"head":-1,"seoMeta":-1},{"_priority":9,"defaultLocale":12,"description":13,"env":14,"name":15,"url":16},{"name":10,"env":11,"url":10,"description":10,"defaultLocale":10},-3,-15,"en","Personal website and blog of Subodh Dahal","production","Subodh Dahal","https://subodhdahal.com",["Set"],["ShallowReactive",19],{"article":-1,"articles-100":-1,"articles-10":-1},"/blog/hiking-tsho-rolpa-lake-trail-in-nepal",1761932344680]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},"seo-utils":{canonicalQueryWhitelist:["page","sort","filter","search","q","category","tag"],canonicalLowercase:true},content:{wsUrl:""}},app:{baseURL:"/",buildId:"3b85eb27-f9e1-4157-a9db-acb8c4a26f62",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>